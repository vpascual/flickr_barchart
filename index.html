<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Demo</title>
</head>
<body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

    <script>
	
	var photos = [];
	var urls = []
	searchPhotos(1, onPageLoaded);	

	function onPageLoaded(data) {
		console.log(photos)
		console.log(data)
		
		photos = photos.concat(data.photos.photo)

	    console.log("Length: " + photos.length)

	    if (data.photos.page < data.photos.pages)
	    	searchPhotos(data.photos.page + 1, onPageLoaded)
	    else
	    	onPhotosLoaded() 
	}

	function searchPhotos(numPage, callback) {
		$.get(
			    "http://api.flickr.com/services/rest/",
			    {
			    	//oauth_nonce : 89601180, 
			    	method : 'flickr.photos.search',
			    	api_key : '4aa644ee462a328d852a34e4a0fe7855',
			    	user_id : '12001399@N05',
			    	min_taken_date : '2012-12-05',
			    	max_taken_date : '2013-05-22',
			    	page : numPage,
			    	format : 'json',
			    	nojsoncallback : 1
			    }, 
			    callback);
	}

 	function onPhotosLoaded() {
 		getPhotosUrls()
 	}

 	function getPhotosUrls() {
 		for (var i = 0; i<photos.length; i++) {
 			photo = photos[i];

 			urls.push("http://farm" + photo.farm + ".staticflickr.com/" + photo.server + "/" + photo.id + "_" + photo.secret + "_b.jpg")
 			console.log(urls[urls.length - 1])
 		}

 		getPhotoInfo(photos[0].id, photos[0].secret, done)
 	}
 	
 	function getPhotoInfo(id, secret, callback) {
 		$.get(
			    "http://api.flickr.com/services/rest/",
			    {
			    	//oauth_nonce : 89601180, 
			    	method : 'flickr.photos.getInfo',
			    	api_key : '4aa644ee462a328d852a34e4a0fe7855',
			    	photo_id : id,
			    	secret : secret,
			    	format : 'json',
			    	nojsoncallback : 1
			    }, 
			    callback);
 	}

 	function done(data) {
 		console.log(data)
 	}

 	/*function getDominantColor(url) {
 		color = getDominantColor(url)
 	}*/

    </script>
</body>
</html>